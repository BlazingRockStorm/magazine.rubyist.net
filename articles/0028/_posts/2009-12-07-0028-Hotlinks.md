---
layout: post
title: Rubyist Hotlinks 【第 22 回】 nari さん
short_title: Rubyist Hotlinks 【第 22 回】 nari さん
tags: 0028 Hotlinks
---


## はじめに

著名な Rubyist にインタビューを行う企画「Rubyist Hotlinks」。
今回は Ruby の最年少コミッタで GC の改善に尽力されている nari さんにお話を伺いました。お楽しみください。

## プロフィール

![nari1.jpg]({{site.baseurl}}/images/0028-Hotlinks/nari1.jpg)
角谷さんの「Java から Ruby へ」のプレゼンをきっかけに Rubyist になった nari さん。RHG で GC に目覚め、独学で GC を学び、現在は Ruby の GC 改善のコミッタとなる。座右の銘は「あきらめない」。

好きな言葉
: あきらめない

尊敬する人
: まつもとさん、前田さん、Rubyのコミッタの方々、竹内先生、角谷さん、松田さん、高橋会長

ご本人のサイト
: [I am Cruby!](http://d.hatena.ne.jp/authorNari/)

## インタビュー

聞き手
: ささだ

語り手
: nari さん

野次馬
: まつもとさん、竹内郁雄先生、高橋会長 [^1]、ごとうゆうぞうさん、角谷信太郎さん、松田さん、yhara さん、あんどうさん

日にち
: 2009 年 9 月 8 日

場　所
: NaCl

### 目次

* Table of content
{:toc}


### プロフィール
: ![nari5.jpg]({{site.baseurl}}/images/0028-Hotlinks/nari5.jpg)

__ささだ__ 今日は久しぶりのインタビューです。お忙しい中ありあがとうございました。 Ruby ワールドカンファレンスの終わった後にこんなことやってすみません。

__nari__ いえいえ……、緊張します。

__ささだ__ 今回はたくさん野次馬が来ています。まつもとさん、竹内郁雄先生、ごとうゆうぞうさん、角谷信太郎さん、松田さん。

__まつもと__ 史上最多のギャラリーじゃないか。

__竹内__ 史上最低のギャラリー (笑)

__まつもと__ いや、最低かどうかは…… (笑)

(右の写真について：左上から角谷さん、竹内先生、yhara さん、ささださん、高橋会長、左下から松田さん、nari さん、ごとうゆうぞうさん。)

#### 生年月日、出身地、現住所、家族構成

__ささだ__ 生まれた年、出身地、現住所、家族構成。いずれも差し支えなければ。

__nari__ 生年月日は、1985 年 3 月 21 日です。

__ささだ__ 80 年代の人にインタビューするのは初めてなんじゃないかという気がします。

__nari__ 出身地は福岡の八女っていうところで、お茶が有名な場所です[^2]。

__ささだ__ 福岡でお茶を作るんですか？

__nari__ お茶作りますよ (笑)

__まつもと__ 日本中、どこだって作るじゃんね。

__ささだ__ 福岡では知らなかった。

__nari__ あと、現住所は松江です。家族構成は、兄と母です。親父はいたんですけど、小五ぐらいのときに亡くなりまして。そんな感じです。

#### 好きな言葉、座右の銘

__ささだ__ 好きな言葉、座右の銘。

__nari__ 座右の銘ですか……。座右の銘……。「あきらめない」とか、そんな感じ。

__ささだ__ 普通ですね。

__nari__ はい (笑)

__まつもと__ それは座右の銘じゃないんじゃない (笑)。

__ささだ__ 何かあるんですか、理由は。

__nari__ や、あんまり特には無いんですけど (笑)。今まで考えると、あんまりあきらめてこなかったな、という。

__まつもと__ いくら GC パッチをリジェクトされてもですね、いつかは。

__nari__ いつか日の目を見ることを夢見て。

__まつもと__ つらいよね。

__nari__ つらいですね。

#### 尊敬する人

__ささだ__ 尊敬する人。

__nari__ 尊敬する人は……。

__まつもと__ ささださん。

__ささだ__ まつもとさんが答えないでください (笑)

__nari__ いっぱいいるんですけど。

__ささだ__ どうぞいっぱい言ってください。

__nari__ まつもとさんと、前田さん。
: ![nari2.jpg]({{site.baseurl}}/images/0028-Hotlinks/nari2.jpg)

__まつもと__ 聞かなかったことにしよう。

__全員__ (笑)

__ささだ__ これは何だろう、給料対策？[^3]

__nari__ いや違います (笑)

__まつもと__ 僕、人事権ないから (笑)。そういう権利は奪われているので、リリースマネージメントと一緒で。

__nari__ あと、Ruby のコミッタの方々です。

__ささだ__ そう言っておけば、パッチが通りやすいと (笑)

__nari__ いや (笑)。前田さんが直属の上司なんですけど、良く色々教えてもらってですね。ああ、すごい人だなというか、すごい人とはこういうことを言うんだみたいな。

__竹内__ 上司と部下の関係があるわけね、NaCl には。

__まつもと__ NaCl にはあります。あんまりそこまでフラットじゃなくて、二階層ぐらいは。社長、前田、中村。

__全員__ (笑)

__竹内__ 社員が 3 人しかいないってことは無いでしょう (笑)

__まつもと__ もうちょっといます (笑)

__ささだ__ 他にいれば。

__nari__ 他に……。誰でしょう……。竹内先生とか。

__ささだ__ 遅いよ (笑)

__竹内__ よく言うよね。

__全員__ (笑)

__竹内__ 明らかに、周りの雰囲気に言わされてるよね (笑)

__nari__ 萎縮してるんです (笑)

__まつもと__ 圧迫面接 (笑)

__竹内__ じゃあ、次は松田君ですとか (笑)

__nari__ そうですね。松田さんと角谷さんです。

__全員__ (笑)

__竹内__ やっぱ帰らないでよかったね。

__nari__ あと、高橋会長ですね。[^4]

__ささだ__ じゃあここで今、なんでとか聞いたら、困りますか？

__nari__ それはちょっと。

#### 代表作

__ささだ__ 代表作。

__nari__ 代表作……。あんまり、そんなに凝って作ったものは無くてですね。

__ささだ__ ソフトウェアはあんまり作ってこなかった？

__nari__ 細かいものは作ってきたんですけど。

__まつもと__ nario [^5]。

__ささだ__ nario。はいはい。

__yhara__ なんで[絶対復習](http://www.takao7.net/brushup/)を言わないの。

__nari__ ああ、絶対復習が。

__ささだ__ 絶対復習。それ、Web サイトですよね。

__nari__ はい。

__ささだ__ 趣味で作ったんですか？

__nari__ あれは趣味です。夜寝てて、ぱっと起きてこれはイケる、みたいな。

__竹内__ かな漢字変換してもらえますか？

__ささだ__ ぜったいふくしゅう？

__竹内__ 「ふくしゅう」がリベンジなのかどうか。

__nari__ あ、リベンジじゃないです (笑)

__竹内__ 「絶対復讐」だと思ったよ。

__まつもと__ 予習復習の復習なんですけど (笑)

__竹内__ 予習復習だよね、やっぱり。

__nari__ それぐらいですかね。あとは GC のパッチですか。代表作っていうほどじゃないんですけど。ささやかなものです。

__ささだ__ 絶対復習って使ったこと無いんですけど、イケると思ったサービスってどんなサービスなんですか。

__nari__ 自分が忘れっぽいのでどうにかしたいなと思っていて。それで本を読んだら、忘却曲線みたいなのが書いてありまして、一週間経つと 20% ぐらいしか覚えていないというのがあって、それにしたがって何回か復習していくというのを作って。それでずっと今やってるんですけど、だいたい覚えてるんで。

__ささだ__ 忘却曲線とサービスの関係は？

__nari__ 僕もよく覚えてないんですよね。

__ささだ__ いやいやいや (笑)。毎日使ってるんでしょ？

__yhara__ そこは復習してなかった？

__nari__ そこは復習して無かったですね。

__全員__ (笑)

__nari__ 登録した復習内容を、一日後と、一週間後と、一ヶ月後と、半年後に教えてくれるんですね。それでそのたびに復習して、知識を定着していくっていう。

__ささだ__ こんなことを勉強したよというトピックだけを入れておいて、勉強した内容自体は、自分でやると。そろそろ復習するんじゃないのというサービスを作ったと。

__nari__ そうです。

__ささだ__ それで色々な GC のアルゴリズムを復習している……、わけではない？

__nari__ はい。してます (笑)

__ささだ__ 何に使ってるのかなと思って。

__nari__ なんですかね？英語の意味とか。最初の頃はやっぱり GC のアルゴリズムをやってました。

__ささだ__ 最初の頃にそういうことをやって、後は？

__nari__ あとは、英語とか。あ、卜部さんの「O(1) の Hash を作るには」[^6]とか、そういうやつですね。後は「宴もたけなわ」の意味とか。

__角谷__ 英語ですか？

__nari__ いや、日本語の。

__全員__ (笑)

__竹内__ でも「宴もたけなわ」の「たけなわ」を漢字で書ける人はほとんどいないと思いますよ。

__全員__ (ここでみんな漢字を調べ始める)

__まつもと__ 2 つあるみたいですね。

__竹内__ 酒には酒が甘くてもいいんですよ。

__まつもと__ 酒に甘いでもいいし、門構えに東みたいな字でもいいと。[^7]

__ささだ__ nario はまだやってるんですか。

__nari__ nario はあんまりやらないようにしていて。

__ささだ__ え、なんで？　京都の方からいろいろ言われたくない？(笑)

__nari__ あんまり蒸し返したくないというのがあって、あんまりやらないというのを会社の中で宣言してて……。黒歴史みたいな (笑)

__ささだ__ 会社でやるのはどうかと思うけど (笑)

__nari__ 会社で、そういうプレゼン [^8] はいたしません、みたいな。

__ささだ__ 誓約書を書かされて？

__nari__ そういうわけじゃないですけど (笑)。昼ごはん食べながら、そういう話をして。

__yhara__ まあ、社会人ですからね (笑)

#### 著作

__ささだ__ 著作。本でも記事でも。あ、るびまで記事を書いてくれましたね[^9]。ありがとうございました。

__nari__ るびまの記事が初めてですね。

__ささだ__ そうなんですか。何度でも書いてください。

__nari__ はい。本は今度出させていただけることになったので。

__ささだ__ GC の本？

__nari__ GC 本です。

__まつもと__ GC 専門本はあんまり無いんですからね。

__竹内__ 本当に無いです。リチャード・ジョーンズの本 [^10] が唯一じゃないですかね。
{% isbn_image_right('0471941484') %}

__まつもと__ 日本版ジョーンズ？

__nari__ あんまり僕、アルゴリズムに詳しくないんで、本の中では実装編を 6 割ぐらいにしようかなと思って。実装を紹介するんですけど、実装を結構多めに取って。

__ささだ__ ペーパーの紹介とかは、4 割ぐらい？

__nari__ そうです。

__ささだ__ 書くきっかけはなんだったんですか？

__nari__ きっかけは、blog にですね、酔っ払いながら 「GC 本が無いんだけど、誰か書かせてくれませんか」っていうのを梅酒を飲みながら書いたんですけど(笑) [^11]。そしたら、次の週ぐらいに「本を書きませんか」っていうメールをいただいて。

__ささだ__ おー。

__まつもと__ じゃあ、何か書きたいものがあったら blog に書けと。

__nari__ blog に書くと、拾ってくれる人がいるかもしれないです。

__ささだ__ まぁ、GC の本を書きたいと言う人はいないですよね。買いたいって言う人もどれぐらいいるか分からないですけど (笑)

__全員__ (笑)

__まつもと__ それは大きな大問題 (笑)。僕は買うから。

__ささだ__ 僕も。献本もらえる気がするけど。

__まつもと__ わかった、献本もらっても買うわ。献本は貰う。

__全員__ (笑)

__ささだ__ 会社用と家用と。

__nari__ 是非是非。ここで 10 部ぐらい (笑)

__全員__ (笑)

__ささだ__ 宣伝しておいた方がいいですよ。

__nari__ えーと、買ってください。

__ささだ__ いやいや、何か売り文句とかは。

__nari__ 売り文句ですか。

__まつもと__ 出たら買ってください。

__全員__ (笑)

__ささだ__ これがいいよとか、こう言う人は買った方が良いよとか。Rails アプリケーション作るときは、これを読んでないと、とか。

__まつもと__ 違うだろうな (笑)。GC を実装する人は買った方がいいよね。

__全員__ (笑)

__ささだ__ 日本に何人いるんだ (笑)

__nari__ Ruby とかから入った人は、多分メモリをあんまり意識しないで使っちゃったりすると思うんで、その辺の人とか、イメージできて良いかなぁと思って。

__ささだ__ 結局、GC があってもメモリを気にしないとダメだと。

__まつもと__ パフォーマンスに悩む Java プログラマは買った方が良いかも知れない。もちろん、VB プログラマも。なぜ、ここで何もしていないはずなのに遅いのか。GC じゃん、というのが分かるかも知れない。

__nari__ そうですね。

__ささだ__ 大学の授業とかでも買わせた方がいいんですか。

__まつもと__ 大学で GC の授業をしているところあるの？電通大？

__竹内__ GC は私は教えてたよ。大学の授業で。

__ささだ__ まえ、和田英一先生が、非常勤で電通大に来られたことがあって、そのときにもぐったら、GC の授業をやってました。

__まつもと__ 素晴らしいね。

__nari__ すごいですね。

__ささだ__ 自分で GC を書いて、色々 Lisp でこうやって、っていう話を。

__まつもと__ 筑波で集中講義をしたときに、GC ちょっとやりましたよ。皆に ID 持たせて、まずリファレンスカウントでやってみましょうって。自分のリファレンスカウントが 0 になった人は席に戻ってくださいって。

__竹内__ なんと面白いことを。

__全員__ おー。

__竹内__ 人をゴミ扱いにするという (笑)

__全員__ (笑)

__まつもと__ あの人は見事生き残りましたとか言って (笑)。じゃ、次の 10 人出てきてくださいとか言って、また ID 振られて。で、今度は Copy GC して見ましょうって、こっちに移ってくださいって(笑)。

__ささだ__ じゃそんな感じで、教科書指定すればよい。そうすれば学生が買うじゃん。

__まつもと__ そういう授業で。じゃ、ささだ先生が教科書指定で。ゼミで。

__全員__ (笑)

__まつもと__ 何人いるんだ (笑)

__竹内__ 去年なんか、3 人しか授業を受けてなかった (笑)

__まつもと__ それじゃしょうがない (笑)

__nari__ じゃ、3 部売れますね (笑)

__まつもと__ でもね、いまどきは小部数出版になってるからね。

__ささだ__ でも RHG が 2500 冊らしいので。まあ、いまプレミアついてますけどね。非常にいい本なんだけどすぐ売り切れちゃって、さすがにもう 1 回出しても売れないだろうということで出さなくて、15000 円くらいになってるらしいんです。
{% isbn_image_right('978-4844317210') %}

__ささだ__ でも web で全部公開しちゃってるからね [^12]。じゃあ、それを目指すと (笑)

__まつもと__ それを目指すということでいいのか？ (笑)

__nari__ じゃあ、初版で売れなくて web で公開すると。

__ささだ__ それでマーケットプレイスですごく高く売れて 2 冊持ってる人がウハウハになるとか。

__まつもと__ うっへっへ (笑)

__ささだ__ wiki 作ってましたよね？ GC の wiki [^13]。あれは何か関係あるんですか。書籍の話と。

__nari__ いやー、あんまり。執筆を依頼していただいた編集者の方はご存じでしたけど。

__まつもと__ いや、関係が無いわけはないよ。

__ささだ__ これだけ書いている人だったらまかせても良かろうと。

__nari__ そういう話なんですかね。あと、Ruby の GC の話を本に書こうと思ったんですけど。でも Ruby の GC って、RHG に載っているので、それは止めてですね。

__まつもと__ えっ (笑)

__nari__ どきっ (笑)。それでですね、[Rubinius](http://rubini.us/) の GC を今書いてます。

__まつもと__ またマイナーな。

__ささだ__ 多分、来年には変わってるよ。

__nari__ Copy GC の部分だけなので、そこぐらいだったら変わらないんじゃないかなぁと思います。

__ささだ__ Copy GC って、結局 copy-on-write friendly じゃないじゃないですか。で、散々何か copy-on-write friendly いいよいいよとか言ってる人たちがいて。

__まつもと__ 良くわかんないよね、あれ。何だろうね。

__ささだ__ その点から見ると、Copy GC って絶対ダメじゃないですか。

__まつもと__ ダメだね。何を言ってるんだろうね。みんな自分の立場から好きなことを言うからね。

__ささだ__ まぁ、Rails のお客さんが大事じゃないですか、色々。

__nari__ 今日も Jeremy Kemper さんが言ってましたね、プレゼンで [^14]。

__松田__ むしろ、お客さんを突き放すようなことしか言ってなかった気が。

__nari__ copy-on-write が入ればいいかなぁとか。

__ささだ__ で、どうやってプロファイリングとか取ってるのとか聞いたら、1.8 の RubyProfile でやってるとか言われて。1.9 でやってないんだみたいな。

#### 好きなメソッド、嫌いなメソッド

__ささだ__ 好きなメソッド、嫌いなメソッド。あ、そうだ、2004 年の 8 月に最初のインタビューをしたんですよ。それから 5 年ぶりですね、ちょうど。

__まつもと__ ああ、それぐらいだったかねぇ。

__ささだ__ 私が最初のインタビューで初めてここ (松江のNaCl) に来て、ここでやりました。5 年間、俺同じ質問してる！

__まつもと__ まぁね。そんな変わるもんじゃないから。

__yhara__ セカンドシーズンですね。

__ささだ__ 2 周目。松江から。

__まつもと__ 好きなメソッドは？[ObjectSpace](http://doc.okkez.net/187/view/class/ObjectSpace).each_object ですとか。そんなはずは無い (笑)

__nari__ ObjectSpace.each_object ですかー (笑)

__まつもと__ 発狂するようなメソッドだよね。

__nari__ ObjectSpace って、何で入っちゃったんですか。経緯みたいなのは。

__まつもと__ いや、ObjectSpace が必要だったから。

__ささだ__ 必要じゃないでしょ、作れちゃったからでしょ、あれは。

__まつもと__ うん、作れたから。

__ささだ__ Continuation と同じで。きっと。で、他の処理系を実装している人たちが困る。

__まつもと__ っていうか、GC に関するメソッドを入れるところは要るじゃん。で、ObjectSpace。

__ささだ__ でも、GC っていうクラス[^15]があるじゃないですか。GC 関係は。

__まつもと__ GC っていうクラスは、最初は無かった。

__nari__ へぇー。

__ささだ__ ああそう。だから、ObjectSpace.gc_start でも良かったかもしれない。

__まつもと__ ObjectSpace.garbage_collect っていうメソッドあるぜ。

__ささだ__ えっ！

__全員__ (笑)

__まつもと__ 昔っから。

__ささだ__ 何するんですか。

__まつもと__ いや、ガベージコレクトをするに決まってるじゃん(笑)。GC をスタートするに決まってるじゃん。

__ささだ__ あ、全然知りませんでした。

__yhara__ どうして GC モジュールが出来たんですか？

__まつもと__ なんだったかな……。enable とか disable とかつけるのに、ObjectSpace につけるのはおかしいって話だったのかな。考えてみれば、ObjectSpace.gc_enable とかにすればよかったかもしれないけど。

__ささだ__ 何か、2 文字って少なすぎますよね。

__まつもと__ すみません。GC が好きなんです。

__全員__ (笑)

__ささだ__ この間、田中哲さんがプロシンで、短い名前より長い名前を先にした方が良いという話をしてたじゃないですか。

__竹内__ あー、言っていましたね。

__ささだ__ 先に長い名前にしておけば、後で短く出来るからっていう。

__yhara__ GarbageCollect モジュールの方がよいと。

__ささだ__ いや、分からないけど。そうすれば誰も使わなくなるから。

__nari__ 僕が困る気がします。

__ささだ__ 一人が困るのは良いんだよ。

__nari__ あ、好きなメソッド……。GC.start。

__角谷__ 予定調和的な (笑)。言わされてる？

__竹内__ 自分で陽に GC を始めるってこと？

__nari__ そうですね。

__まつもと__ それは悪手じゃないのか？もしかして (笑)

__竹内__ 暇そうだから？

__まつもと__ そうそう。

__竹内__ 昼飯行くから GC.start とかやって。

__ささだ__ ゲームプログラミングだと、フレームの単位で、フレーム処理が終わったら GC してっていう風にやるそうですね。と、星君が言ってました。

__まつもと__ もうここは暇だってはっきり分かってるときに、GC かけるってことかな。

__nari__ アプリケーション書いている人しか、暇なところが判断しづらいと思うんで、GC.start は結構僕は好きかもしれません。

__ささだ__ でもさ、GC 実装者としては負けじゃないの、それ。

__まつもと__ そう、負けな気がする。

__ささだ__ 自動的に勝手にメモリ管理してくれるってのが大事なんじゃないの？

__まつもと__ いかに賢く出来るか。

__nari__ そうですよね……。

__ささだ__ まぁ、でも好きだと (笑)。じゃ、嫌いなメソッド。

__nari__ GC.disable じゃないですか。

__まつもと__ 止めちゃダメなんだ (笑)。

__全員__ (笑)

__まつもと__ でも disable はほんとに負けな気がする、たしかに。

__竹内__ disable ってどういうこと？

__まつもと__ このリージョンではメモリがいっぱいになっても必ず GC はしない。

__竹内__ いっぱいになったらどうすんの？

__まつもと__ もう落ちるしかないですね。MemoryFailure で。

__竹内__ ObjectSpace を増やすってのは無いの？ ObjectSpace.increase とか。

__まつもと__ それは勝手に malloc でメモリ空間から切り取ってくるんで、どんどん膨れ上がるんですけど。

__竹内__ GC はしてほしくないと。それが disable ですか。

__まつもと__ disable です。すごい負けな気がする。たしかに嫌いだ。

### Ruby に関して

#### Rubyist になったきっかけ

__ささだ__ Ruby について。Rubyist になったきっかけ。つーか、Rubyist なの？あ、そっか、Ruby 検定受けてましたよね。

__nari__ 認定されました[^16]。

__ささだ__ 認定された。

__まつもと__ 仕事でも Ruby 書いてるし。

__nari__ きっかけはですね、前の会社では 2 年ぐらいずっと Java を使ってたんですけど、Ruby っていうのがちょこちょこニュースとかで出てきてですね。で、角谷さんのプレゼン動画を見たんですよ。

__ささだ__ おっ。いないじゃん今！[^17]　何て人だ (笑)。何のプレゼンですか？

__nari__ Google Video に入ってるやつなんですけど……。

__ささだ__ いつ頃の？

__nari__ 2 年ぐらい前じゃないですかね。

__ささだ__ デブサミかなんかすかね。

__nari__ いや、デブサミじゃなかったですね。

__ささだ__ 2 年前……。今、角谷さん褒められてますよ。

__角谷__ えっ。なんですか。

__ささだ__ なんか Ruby を始めたきっかけが、2 年ぐらい前に角谷さんのプレゼンを見たことだって。

__角谷__ ありがとうございます。

__nari__ Google Videoに……。

__ささだ__ で、なんのビデオかと。

__角谷__ サッカーじゃなくて？

__ささだ__ サッカーじゃなくて (笑)

__角谷__ Google Video に上げてた頃は大分昔ですね。

__nari__ あ、社内向けの「Java から Ruby へ」です。

__角谷__ ああ、あの話。おおー。

__ささだ__ あの本[^18]を書いた後で？
{% isbn_image_right('4873113202') %}

__角谷__ 出す前ですね。間に合わなくて。

__ささだ__ これ[^19]ですね。

__角谷__ おおー。品川でやってた奴ですね。恥ずかしいから再生しないで (笑)

__全員__ (笑)

__角谷__ いや、おかげで GC のコミッタが釣れたという (笑)。貢献してる、俺 (笑)。Ruby の開発に貢献した！

__ささだ__ それを見て、Ruby が良いなと。

__nari__ はい。

__ささだ__ そこで普通さ、Ruby で書こうってなるよね。

__nari__ 最初は書いてたんですよ。最初は Rails で何か作ったんですよ。

__ささだ__ 趣味で？

__nari__ はい。UFO を捕まえるようなアプリケーションを作ってですね。

__まつもと__ やっぱりゲームなんだ。

__ささだ__ Rails で？

__nari__ Rails で。

__ささだ__ Web アプリで UFO つかまえるの？

__nari__ Google Map に UFO が乗ってですね、瞬間移動するんで、そこの座標に行って捕まえると言う。それをやりましたね。あと、[ホワイの (感動的) Ruby ガイド](http://www.aoky.net/articles/why_poignant_guide_to_ruby/)を読んで、すごいなーと思って。

__ささだ__ なるほど。

__nari__ それがきっかけですかね。

__ささだ__ で、思い余って NaCl に来た。

__nari__ そうです (笑)

#### 現在の Ruby との付き合い

__ささだ__ 現在の Ruby との付き合いを教えてください。

__nari__ ほぼ Ruby というか、仕事でも Ruby を使ってますし。家でも……家ではそんなに使ってないですね、今は。前は使ってましたけど。でも、GC についてどうにかできないかなっていうのを考えたりするようなポジションですかね。

__ささだ__ このタイミングしかないような気がするので。何かアイデアがあれば。Ruby の GC について。

__nari__ なんか、ゲームのライブラリを作ってる人の blog[^20] でですね、結構止まるっていうのがちょこちょこ載ってて。それはどうにかしてあげたいなと思うんですけど。

__ささだ__ では、パフォーマンスはあんまり気にしないんですか？　GC のモチベーションって、今どこにあるんですか？　何したい？

__まつもと__ たたみかけるような質問ですね。答える間がない (笑)

__nari__ 僕のですか？

__ささだ__ うん。何をしたいの？

__nari__ なんでしょう。何がしたいんでしょうね。あ、でも普通に GC について知ったり、アルゴリズムについて知ったり、こういうやり方もあるんだって、それの目標は Ruby の GC にどうやって改善していくかみたいな。

__ささだ__ 改善の方向って、色々あるじゃん。

__nari__ まず、手近なとこだと、LazySweep 入れたいなと思ってます。

__ささだ__ じゃあ、リアルタイム性をあげたいとか、スループットをあげたいとか。

__nari__ 選択できるのがいいかな。

__ささだ__ ああ、選択可能にしたい。

__nari__ はい。

__ささだ__ おー、GC アルゴリズムを変えられるようにしたいと。

__nari__ したいです。

__ささだ__ なんか、EngineYard の人たちが喜びそうですよね。

__まつもと__ うん。でも大変だよね。

__ささだ__ 竹内先生が GC 作ってたときは、GC はこれだけっていう感じだったんですか？それともなんか選べるように作ったんですか？

__竹内__ いやー、もちろん 1 つだけですよ。私が作ったのは 10 年以上前ですけど、ポーズタイムは 100 マイクロ sec 以下ですからね。しかも、まだメガヘルツの時代ですよ。60MHz のマシンですよ。ようするに concurrent GC なので、GC のプロセスだけで全部で 8 つ走るんですよ。

__まつもと__ えっ？

__竹内__ 普通の意味で言うとスレッドなんだけども、マーキングのスレッドが 2 つと専用のデータタイプ別コレクションのスレッドが同時に走って、必要なやつからどんどん、どんどん足りなくなったやつから優先度で走るわけ。で、GC のマーキングが 2 つあるのはですね、snapshot at the beggining じゃなくて、dynamic のやつな方なので、ようするに pointer が付け替えられたときに、snapshot は前のやつを取っとくでしょ？

__まつもと__ とりますね。

__竹内__ でもそれは無駄だからやらなくて。どっちかっていうとすぐゴミになりそうなもんじゃない？だからそれはやらなくて付け替える先のものをマークするというそういう方式なんですよ。そっちの方が基本的にコンサバティブじゃないのでゴミの出る確率がすくない。というか、ゴミの回収効率が高い！

__まつもと__ まあ、仕事は減りそうですね。

__竹内__ そのためにどうしてもですね、尻拭いのマーキングってのが必要になって、尻拭い専用のマーキングプロセスがあるんですよ。そこでほんちゃんマーキングと尻拭いマーキングのバランスが悪くなると、尻拭いが走って、尻拭いのやつを少し負荷を減らしてからまたほんちゃんマーキングが走るようになってるんです。

__ささだ__ それをコンカレントで管理してという。

__まつもと__ 正直発狂しそうなんですけど、実装する方は (笑)

__ささだ__ GC するまえにガーってやるのかと思っていました。

__竹内__ そんなことない、そんなことない。普通に dynamic にやってた。スケジューラは GC の残りのメモリひっぱぐために GC 中は優先度を dynamic に変えるんですよ。だから非常にメモリが足りない！しかしもう速く終わらないといけない！というときはどんどん GC の優先度が高くなっていくわけ。

__ささだ__ なんか、プロセッサから OS からすべてのレイヤを作ってたからこそできるっていう。

__竹内__ そうそうそう。だからプロセッサステートワードに GC に関する bit があるわけですから、ブランチがただでできる。

__nari__ たしかに。そうですよね。

__ささだ__ 書かないと、本に。

__nari__ (笑)

__竹内__ あ、後で論文送ってあげます。読むのしんどいと思いますけど。

__nari__ ぜひぜひ。

__まつもと__ タイプタグとかあったんですよね？

__竹内__ もちろんあります。だから GC のマーキングは 64way branch なんですよ。データタイプごとにズボって 1 発あるんです。だから今のパイプラインじゃ無理ですね。

__まつもと__ そうですね。

__竹内__ だから 60MHz のマシンでそんなスピードが出るんですよ。

__ささだ__ だから、それ 1 個でいいっていう判断だったんですね。アルゴリズムを変えるというのは、ハードウェアだから変えるのがしんどい？

__竹内__ だからそれは変える意味があんまりないんですよ。それが 1 つあれば。ベストのものを 1 つ作ればそれで終わりなんですよ。

__ささだ__ GC でベストのものってなかなか言いづらいですよね？

__まつもと__ 上から下まであるから言えることだよね。

__竹内__ だからね、OS に非依存で作らないといけないとか言うと大変だよね。

__まつもと__ すいません、死にそうです(笑)。なんか、湯淺先生と話するとそんなの簡単じゃんって言われるんですけど、どうしたらいいんでしょうか (笑)

__竹内__ いやー、私はあんまりそういうとこには突っ込みたくないなぁ。

__ささだ__ 簡単って何が？

__まつもと__ いや、ライトバリア作って、速い実装書くのって簡単じゃんっとかって言って。いやー、どうしたらいいんだろうかって (笑)

__竹内__ 私は GC は昔から密接ですけども、Virtual Memory と同じで、ハードウェアサポートが無いとやってられない、だからもう OS の下からやらないとというのが私の持論。だっていくらでも速くできるんだから。

__まつもと__ GC のある OS って無いですよね。

__ささだ__ って、なんの話でしたっけ (笑)

__まつもと__ 全然インタビューになって無いじゃん (笑)

__ささだ__ そうか、モチベーションの話をして、selective にって話でしたね。インクリメンタル化したいんだっけ？

__nari__ したいです。

__まつもと__ 割とゲーム畑の人だから、やっぱりリアルタイム性っていうか、ポーズタイムが気になる。

__nari__ 気になりますね。

__ささだ__ スループットはあまり気にしない。

__nari__ うーん。

__ささだ__ サーバー系のアプリケーションって、リアルタイム性って要るんですか。要するに GC で止まって欲しくないとか。

__松田__ あんまり無いんじゃないですかね。そんなピンポイントで止まるって言うのは。

__ささだ__ ひとつのリクエストが 1 秒かかっちゃったみたいな。そんなの気にしない？

__まつもと__ あんまりひどいとあるとは思うけど。Web 系はスループットが重視されるんじゃないかなぁ。

__ささだ__ ライフゲームのインタラクティブ性よりは、ライフゲームが何回進化できたかみたいな。

__まつもと__ ライフゲームで言うの、それ。まぁ、いいけど (笑)

__ささだ__ まつもとさんの論文にはいつもライフゲームでの評価が出てくるから。

__まつもと__ すみません。そういう意味でね (笑)。僕はスループット主義。

__竹内__ るびまの初心読者のために教えて欲しいんですけど、Ruby の GC って、どういうアルゴリズムなんですか。

__まつもと__ すっごいシンプルな Mark &amp; Sweep です。

__竹内__ インクリメンタルでもなんでもなくて？

__まつもと__ なんでもないです。

__竹内__ LazySweep もやってない。

__まつもと__ LazySweep もやってないです。彼 (nari さん) はそういうパッチを書いてるんですけど、まだ取り込まれてない。バグが取れないとね。

__竹内__ LazySweep なんて、物凄く簡単……、あ、でも簡単でもないか。

__まつもと__ いや、簡単は簡単ですし、パッチもそんなに大きくなかったよね。

__nari__ バグは一応直ったんですけど。

__まつもと__ そうなんだ。じゃ、入れようか。
: ![nari4.jpg]({{site.baseurl}}/images/0028-Hotlinks/nari4.jpg)

__nari__ (笑)　オプションで選択できるようにしてからにしたいなーと。

__まつもと__ なんでオプションにするの。LazySweep にして不利なことってあった？

__竹内__ マークビットが立ったやつがあったままで、ミューテーターが走らないといけないんで。そいつをどうするかだね。めんどくさいでしょ、それは。

__ささだ__ どれくらい Lazy にやるかで、ある一定区間は足りなければまとめて Sweep してっていう風にやれば、その問題はたぶんないので。

__まつもと__ Ruby の GC でやってるのは、スタックが深くなりすぎたときに、再帰をあきらめちゃうっていう Knuth のアルゴリズムだけは入れてるんですけど。

__竹内__ うわー、そんなことやってるんだ。

__まつもと__ Ruby の場合は、物凄い長いオブジェクトのチェーンとか作る人がいるんで[^21]、再帰でやってるとスタックオーバーフローとか言われちゃうんで。その、Knuth のアルゴリズムだけは入れました。そこであきらめてしまって、今マークがあるところから、もう一回 Mark &amp; Sweep を再開すると言うアルゴリズム。

__竹内__ 分かりました。

__ささだ__ 私もどちらかと言うとスループット派です。インクリメンタル化すると遅くなるじゃん、ベンチマークが。

__nari__ そうなんですよね。遅くなるので、オプションで出来る人だけ出来るようにして、通常はそんなに遅くならない。

__ささだ__ でも、ライトバリアの有り無しを選択するのって大変じゃない？起動時に。

__nari__ ライトバリアの有り無しのオプション？

__まつもと__ LazySweep はライトバリア要らないでしょ？

__ささだ__ LazySweep は大丈夫ですけど、ちょっと遅くなるかな。

__まつもと__ 遅くはなるけど、ライトバリアは要らないでしょ。

__ささだ__ Mark まで考えたら、ということ。Mark はライトバリアかリードバリアが要るじゃん。

__nari__ インクリメンタルはそうですね。

__まつもと__ そっちは大変。

__ささだ__ (角谷さんに) あ、もうお帰りで。お疲れ様です。何か聞いておきたいこととかありますか。

__角谷__ GC は外国人が気にしてるのでがんばってください。

__nari__ はい、わかりました (笑)

__ささだ__ 彼らはなんであんなに気にするんですかね。

__角谷__ すごく、「GC tuning! GC tuning!」って言ってますよね。

__ささだ__ Ruby on Rails やってる人たちは、みんな GC、GC って言ってて。GC 知らないくせに。

__竹内__ そこで反応がパカッと止まるってこと？

__まつもと__ 何なんだろうね。

__ささだ__ なぜなのか、よく分からないですけど。

__松田__ エンタープライズエディション [^22]ってやつをわざわざ作って、GC のチューニングを変えてて [^23]。それで Twitter が 30% 速くなったとか言ってましたね [^24]。

__竹内__ 良く分からないな。なんで GC が関係あるんだろう。

__ささだ__ Ruby on Rails で Twitter を作ってたんで、そこでパフォーマンスが改善したって話だと思うんですけど。

__松田__ GC をチューニングしたら 30% 速度向上したぞ、と。

__竹内__ 何の速度なんですか。何を速度といっているのか。投稿してから、皆のところに出てくるまでの速度なのか。

__ささだ__ それか、1 時間に何リクエストさばいたか。

__竹内__ さばける数か。GC が延々と走ったらやっぱ遅くなると。

__まつもと__ どうなんでしょう。

__ささだ__ 例えば、fork できる限界ってメモリ優先度によるので、それが copy-on-write friendly にすると、たくさんプロセスが出来てスループットがあがったっていうのがありそうな。

__竹内__ そういうあがり方ね。

__ささだ__ 無いですか？

__まつもと__ 無いとは言わないけど、良くわかんないな。自分で見てないし。それは確かにそういう人がいるよね、ぐらいしか言えなくて。

__ささだ__ ちょっと真面目に取らないとなと思って。アプリケーションどうしようっていう。

__まつもと__ あの辺が謎なんですけど。copy-on-write friendly パッチが遅くなる。

__ささだ__ 今ちょっと、その辺を速くするのは作ろうと思ってて。

__まつもと__ どうやって？

__ささだ__ 昨日言ってた、mmap がどうとかそういう話で。4KB 境界にするから。

__まつもと__ そうか、4KB 境界にするから、ビット操作でだせるって？

__竹内__ 去年の研究会の発表ね。

__まつもと__ 発表みたいな無駄なことはやらずに、もっと。

__竹内__ 何が無駄だったの？

__まつもと__ 境界が分からないので、境界の部分にあたるワードに、先頭を示すインダイレクトなポインタを置きましょうっていう。

__竹内__ あー。

__まつもと__ すべてを malloc でアラインして……。

__竹内__ なんでそうしないのかなと思ってたんだけど、4KB だったらちょっとぐらい端っこの 2,3KB ぐらい無駄があってもいいじゃないとかって、あの時は私もそう思った。

__まつもと__ ちゃんとアライメントとるポータブルなのが無かったとか言う話かな。

__ささだ__ posix_memalign があるじゃないですか！　POSIX ではできるので。Windows じゃできないとか言ってるけど、とりあえず POSIX で評価とらないと。

__まつもと__ それって、ささだ君のパッチだと、VirtualAlloc でやったとかじゃなかったっけ？それはアライメントあるの？

__ささだ__ はい。基本的にページ単位なので。

__まつもと__ じゃ、その問題も無いのね。

__ささだ__ はい。で、その辺をちょっとやってみて、ほらすごいだろうって言ってみようかなと。

__まつもと__ copy-on-write friendly にしたよって？

__nari__ いいですね。

__ささだ__ で、停止時間の話なんだけど、最近だと、Java の GC をインクリメンタルにしてるじゃないですか。エンタープライズなサーバで。何十ギガもつんでるマシンだと、停止時間が馬鹿にならないからとか。それだとやっぱりインクリメンタル GC が要るんじゃないかな？サーバマシンでは。

__まつもと__ ポーズタイムそのものが結構馬鹿にならないからね。。

__ささだ__ 5 秒とか待つらしいよ。

__nari__ そうなんですか。めちゃめちゃでかいメモリ。

__まつもと__ ギガバイト単位でメモリがあれば時間かかるからね。

__nari__ Java にコンカレントの奴があるじゃないですか、すでに。Java 7 で入った、G1GC でしたっけ。

__ささだ__ そのためのはずでしょ、確か。

__nari__ そのためです。でも、その前にコンカレントなGC[^25]がありましたが……。

__ささだ__ 2000 年か 2001 年の。

__nari__ あれだとダメだったんですかね。

__ささだ__ 何かその辺は良く分からないので。

__まつもと__ コンカレントって言ってたやつも、結局は単なる世代別 GC だったので。マイナー GC は問題ないんだけど、メジャー GC がおきたときに、同じことがおきて、フル GC で例えば 5 秒止まるのは、受け入れられるかって話で、それはダメじゃんとかいう話でなかったかな。

__nari__ フル GC はコンカレントでは無かったですね。

__まつもと__ そうそう。で、G1GC は、何だか良く分からないんだけど、メジャー GC って無いんだよね、あれ。

__ささだ__ 世代別 GC なんですか？

__まつもと__ 世代別……、セグメント別っていうのかな。

__nari__ 割合を見てそこに退避して、みたいな。

__まつもと__ 良くわかんないんだけど、ライトバリアで、どのぐらい生きているかの大体の目安を取ってるんで、一番ゴミが多そうなセグメントがマイナー GC するとかいうアルゴリズムなんだわさ。

__nari__ 論文[^26]読んだんですけど、わかんなかったですね。

__まつもと__ 僕も。で、なんか G1GC 特許取ってるしさ。

__ささだ__ Ruby には入れらんない。

__nari__ 本に書いて良いんですかね。

__まつもと__ 説明する分にはいいんじゃない？

__ささだ__ でも、特許とってるって書かないといけないのか。

__まつもと__ その情報はあった方がいいよね。

__ささだ__ クックパッドの人に、memory usage で困ってないんですかって聞いたんですよ。聞いてみたら、「クックパッドのマシンは、メモリ 16 ギガ載せてるので、全然メモリ困ってません」とか言われて。

__全員__ (笑)
: ![nari6.jpg]({{site.baseurl}}/images/0028-Hotlinks/nari6.jpg)

__まつもと__ GC しないんじゃないの、もしかして (笑)

__ささだ__ copy-on-write friendly とか要らないですとか言われてしまって。

__nari__ GC が要らない世界って来るんですかね。

__まつもと__ それはさすがに。僕が生きている間には来ない気がする。

__ささだ__ 昔、ジョークで「ハードディスクが 1GB になったときに、全部ハードディスクに入れちゃえばいいから要らないよね」っていうのがあった。

__まつもと__ 1TB になっても、まだ GC っぽいことはあるしね。

__竹内__ あるでしょう。無駄遣いする人いっぱいいるから。

#### Ruby の好きなところ、嫌いなところ

__ささだ__ Ruby の好きなところ、嫌いなところ。

__nari__ 好きなところは、やっぱり使ってて書き易いというか、気持ち良いというか。その辺ですかね。あと GC が僕でも改善できそうなところとか。

__ささだ__ GC がダメだってこと？

__nari__ いや、ダメじゃないですけど (笑)。僕なんかでも改善できそうな余地がありそうな。

__ささだ__ Ruby の嫌いな所は。

__nari__ GC に関しては、いじれそうなんですけど、実際にいじるとすごい難しいっていう。

__全員__ (笑)

__ささだ__ 下手にいじると、何か怒られるし。

__まつもと__ 僕は怒らないよ。

__nari__ 嫌いじゃないですけど、そんなところです。

#### Ruby を使った成功事例

__ささだ__ Ruby の成功事例。本が書けたぜ。

__nari__ ああ、本が書けました。「本を書くよ」って偉そうに地元の友人に言ったんですけど。そしたらその後「先生、先生」って感じでビールを注ぎに来てですね。冗談でこびを沢山売られました。

__ささだ__ ああ、そうか。これから私も先生ということでやんなきゃいけないと。お酌しなきゃいけないんですね (笑)

__nari__ まさか自分が本を書くとは思ってなかったので、5 年ぐらい前までは。

__まつもと__ 5 年前って、19 歳？

__nari__ はい、まだ工場にいたときです。

__ささだ__ 同人誌とか。

__nari__ 同人誌 (笑)

#### Ruby のキラーアプリケーション

__ささだ__ Ruby のキラーアプリケーションとかあります？使ってる方。他人のでも、自分のでも。

__nari__ あー、[Sinatra](http://www.sinatrarb.com/) とか結構。キラーアプリじゃないですけど。自分でちょこっと作るにはすごい良かったり。最近は Sinatra が結構好き。

__ささだ__ へー。流行ってますよね。

#### Ruby の習得

__ささだ__ Ruby の習得はいかがでしたか。

__nari__ Java から入ったんで、全部オブジェクトっていうのが良く分からなくてですね、その辺がわかんないなーと思いながらやってました。クラスはあるんですけど、オブジェクトってどういうことなんだろうっていう感じでした。でも、あんまり今も分かってない気はしますけど。

__ささだ__ GC のことが分かっていれば、大体どんなゴミがあるか分かってるんじゃ。

__nari__ (笑)。中を知って「あー」みたいな感じ。

__ささだ__ なるほど。

#### 一般人の Ruby に対する認識

__竹内__ 全然関係ないけど、昨日会場からバスでホテルまで送ってくれた運転手さんとずいぶん親しくなったんだよ。で、その運転手さんが「この Ruby なんたらカンファレンスってのは、Ruby の会ですよね。」って聞いてきたから「そうですよ。」って言ったんだけど、どうみてもあの Ruby だと思ってるわけ。

__まつもと__ 宝石ね。

__竹内__ 宝石の Ruby。なんかね、宝石を磨く技術に関する会だと思ったらしいんだよ。で「カンファレンス」の意味がわからなかったから辞書を引いたんだよ、彼は。そしたら「会議」だから、「Ruby の磨き方に関する会議ですよね」って言われて、うーん……と。だから、一般人はそうらしいんだよ。

__全員__ (笑)

__まつもと__ あ、でもそうだと思いますよ。昔、中京大学で公開講座したんですけど、地下鉄にポスターを貼ってたらしいんですよ。そしたら問い合わせが来てですね、「あのー、私も聞きたいんですけど、宝石の鑑定ができるようになるんでしょうか？」って。

__全員__ (笑)

__まつもと__ ちょっと誤解は深いなと。

__竹内__ 深いね。

__まつもと__ Python とかにしとけばよかったですね。

__全員__ (笑)

__まつもと__ 逆にヘビ好きなんですけど、って人が来そうだな (笑)

__ささだ__ まあ、確かにあの宝石を見ても、プログラミング言語とはわかんないですよね。

__まつもと__ プロが見るとこれは Ruby のカットじゃないって思うんですけどね。ブリリアントカットでダイヤモンド用でしょって突っ込みが。

__竹内__ 遠くから見ると何にもわかんない？

__まつもと__ ソフトウェアとはわかんないですね。

__あんどう__ それらしい情報が無いですよね。

__まつもと__ なんて不親切な (笑)

__竹内__ Ruby を削るテクノロジーの会議で Ruby の標準化の話をして [^27]。あ、Ruby のケーススタディは、Ruby をどんな箱に入れればいいかを検討する会だね。

__まつもと__ どうしよう (笑)

__全員__ (笑)

### プログラミング全般

#### 初めてのプログラミング

__ささだ__ 初めてコードを書いたのはいつぐらいですか。Ruby じゃ無くて一般的な話。

__nari__ 多分、高校一年生ぐらい。ポケコンを貰ってですね、学校から。そのポケコンで BASIC を書いたっていうのが初ですね。じゃんけんゲームか何か作ったんですけど。それが初だと思います。

__ささだ__ すぐ飽きた？

__nari__ 飽きました (笑) そこからは全然やらなかったですね。

__ささだ__ で、お仕事でプログラミング？やってたからお仕事を選んだっていうわけじゃなくて？

__nari__ あ、その時のことを思い出して転職した、という感じですかね。やっぱり面白かったんだなぁというか。

__ささだ__ じゃんけんゲームが？

__nari__ 中学校ぐらいのときにパソコンを買ってもらったんですよ、すごいおねだりして。当時はすごい高くて、30 万ぐらいしたんですけど。

__ささだ__ したした。

__nari__ すごい無理して買ってもらったんで、何かやろうと思ったんですけど、ネットにつながってなくて。

__ささだ__ 中学っていつぐらい？

__nari__ 10 年前ですね。まだ ISDN だった時代です。うちの田舎は ISDN が来てなくてですね、電話線でネットやってたらすごい高くて。ネットやるなって怒られて。それで全然広がらなくて、そのまま放っといたんですね、PC を。で、それが悪いなという気持ちもあって、将来なんかやりたいなというのが、心の奥の方にあったみたいな。

#### Ruby 以外のプログラミング言語

__ささだ__ Ruby 以外のプログラミング言語はどうですか。

__nari__ Ruby 以外は、Java ですかね。

__ささだ__ C じゃなくて Java なんだ。

__nari__ あ、C と Java。

__ささだ__ でも Java が好き。

__nari__ いや。好きな言語だと C ですかね。

__まつもと__ C いいよね。

__nari__ (笑)

__まつもと__ これ、脅されてるんじゃないの (笑)

__全員__ (笑)

__竹内__ 発言頻度が、中村さんが一番少ない気がする (笑)

__まつもと__ もう黙ります (笑)

__nari__ C ですかね、やっぱり。

__ささだ__ Java は使うけど嫌い？

__nari__ もう使ってないですね。2 年ぐらい使ってないですね。

__ささだ__ 仕事が変わってから使ってないってこと？

__nari__ はい。

#### 美しいソースコード

__ささだ__ 今まで読んだ中でもっとも美しいソースコードはなんですか。

__nari__ あー。

__ささだ__ GC の実装を読んでるでしょ、たくさん。

__nari__ あ、はい。

__ささだ__ 読みやすかった奴。

__nari__ Rubinius のやつはかなり読みやすかったです。C++ で書かれてるので、ゲッと思ったんですけど、慣れると結構読みやすいなと。あと、Python がすごいコメント書いてあってですね、うれしいなと。

__ささだ__ Python、コメントがあっても私はそんなに読みやすいとは思わなかったんだけどな。

__nari__ あ、そうですか？

__ささだ__ でも、ドキュメントがあるのはいいですよね。

__nari__ 何でこのコードがあるのかが書いてあると、最初に入りやすい。

__ささだ__ 私は一切書かないんでダメなんですよ。書かなきゃなと思って。

__まつもと__ 僕もあんまり書かないな。

__ささだ__ まつもとさんは書かないですよね。

__竹内__ 10 年後に、自分で読んで分からなくなるよ。

__まつもと__ 分かりますよ。

__ささだ__ 10 年後じゃなくても、分かってないです、私 (笑)

__まつもと__ 僕はあんまりそういうのは無いな。未来の自分が読んで分からないなと思ったコードには、コメントを書く。

__竹内__ それは正しいかもね。見積もりを誤ると大変だね。

__まつもと__ 大変ですね(笑)。思ったより能力が下がってたりとかね。今のところ、まだ大丈夫みたいです (笑)

__nari__ Ruby って、コメント少ないですよね。

__まつもと__ 少ないですね。僕はそう言う人なんで。

__ささだ__ 今、yugui さんが、[Doxygen](http://www.doxygen.jp/) のコメントシステムを作ってくれたんで。きっと何とかなるに違いない……と。綺麗なコードは Rubinius。Rubinius は、みんな読むべきである。

__nari__ (笑)。……はい。

__全員__ (笑)

__竹内__ これさ、おかしいよね (笑)

__まつもと__ なんという誘導尋問 (笑)

__ささだ__ いや、「あんなの読まなくてもいい」でもいいんで (笑)

__nari__ いや、読んだ方がいいんじゃないですかね。

__ささだ__ 分かりました。Rubinius 完全解説を次回作で。

__nari__ GC の部分しか (笑)

#### 今興味を持っているテーマ

__ささだ__ 今興味を持っているテーマは何ですか。

__nari__ GC です。

__ささだ__ GC 以外は無いんですか。

__nari__ 前田さんとかにも、それ以外の奴をなんか見つけた方が良いってよく言われるんですけど、今のところはあんまり……。

__まつもと__ Python の GC。GC なの？今でも GC じゃないんじゃないの？

__ささだ__ リファレンスカウントじゃないですか。

__nari__ あ、リファレンスカウントって、GC って呼ばないですか？

__竹内__ GC ですよ。立派に GC です。

__まつもと__ GC ……。うーん……。

__ささだ__ 異論があるみたいですけど。

__まつもと__ いや、はい。GC です。

__全員__ (笑)

### 生い立ち

#### 生い立ちについて

__ささだ__ 生い立ち。小中高、何かやってたか。

__nari__ 中学校のときは、田舎だったんで、30 人ぐらいのクラスなんですよ。1 クラス。

__ささだ__ 学校が 30 人とかじゃなくて。

__nari__ 全部で 100 人ぐらいでした。みんな和気藹々とやってて、すごい楽しかったなーっていう。で、工業高校行って。情報科を受験したんですけど、落ちちゃってですね。転科になって、電子機械科に入ったんですね。で、卒業してアイス工場に入るんですよ。機械系で。

__ささだ__ 旋盤がどうのっていう機械？工業高校でそういうことをやってたんですか？

__nari__ やってました。旋盤でぐいーんとやったり、CAD で設計したり。

__ささだ__ アイス工場では、メンテナンスをしてたの？

__nari__ 最初はメンテナンスっていうことで入ったんですけど、途中ぐらいから流れ作業をやっててですね。アイスがこう、ボコって抜けて包装機にヒューって入ってくんですけど、そこの途中の板にアイスがくっつくので、そこからアイスを引っぺがすっていうのを 1 時間ぐらいやったり。

__ささだ__ メンテナンスする対象が無くて暇だろうお前、やれよみたいな。

__nari__ ある時に社員がガーっと辞めちゃって、君もやれよという。

__ささだ__ 不景気でとか、そういう話？

__nari__ 何でだろう。嫌だったのかも。

__まつもと__ 嫌で (笑)

__ささだ__ 集団で？

__nari__ なぜか集団で。ぞろぞろ 5、6 人辞めちゃって。そういうのをやってましたね。そこでは、ダンボールをいかに速く作るか、みたいなこと真剣に考えてやってました。いい経験でした。

__ささだ__ おお。その経験から GC？

__nari__ (笑)。そうですね……。そうですねじゃなくて。

__ささだ__ (笑)

__nari__ そうですねって言っちゃダメですね (笑)

__ささだ__ じゃ、計算機は全然関係なかった。

__nari__ 全然関係ないです。

__ささだ__ で、アイス工場を嫌で辞めたってこと？

__nari__ 嫌ではなかったんですけど。何か、流れ作業をやってて、これで一生終わるっていうのはちょっといかんなということで (笑)[^28]。そんなときに友人の結婚式があって、そこで、色んな職業の人と話をしてですね。あ、でもこういう世界もあるなって思って、コンピュータ系の方に行こうと思いました。

__ささだ__ 友人の結婚式で、彼女じゃなくて職を見つけた。

__nari__ 職を見つけました (笑)

__ささだ__ すごい。

__nari__ で、そこからは、半年ぐらいコンピュータスクールに行って。そこの学費は今考えると結構高くて……。

__ささだ__ それは民間？

__nari__ 民間です。

__ささだ__ 民間のは高そうだよね。

__nari__ 半年で 100 万ぐらい。

__まつもと__ でもそんなもんじゃない？
: ![nari3.jpg]({{site.baseurl}}/images/0028-Hotlinks/nari3.jpg)

__nari__ で、それがまるごと借金になってですね、その次の会社では借金を返すまで働きました。

__ささだ__ 友人の結婚式があって、思い立って、まず辞めて？

__nari__ まず思い立ってですね、そんな時にちょうど新聞にコンピュータスクールのチラシが入っていて、これだと思って行こうって決めて。どうやったらプログラマになれるのかっていう情報があんまり僕の中に無くてですね。

__ささだ__ あ、そうか。周りもいないから。

__nari__ そうです。なので、そういう所に行けば、とりあえず就職は出来るかなと。

__ささだ__ それこそ、2ch とかみたりとか (笑)

__nari__ そのときも、ネットはモデムだったんですよ。

__ささだ__ 携帯とかではみてなかった？

__nari__ 見てないですね。

__竹内__ 何年前の話？　ずいぶん昔の話なんじゃないの？

__まつもと__ 彼はずいぶん新しいので (笑)

__竹内__ 携帯でそんなもの見る時代じゃないんじゃないの？

__ささだ__ 2005 年ぐらいですよね？ i モードは？

__nari__ i モードはありました。

__まつもと__ 我々を振り返ると、何もかも最近に感じる (笑)

__ささだ__ 他業種に行くっていうのは、人づてで無いと情報が無いっていう感じ？

__まつもと__ 割と業界の情報っていうのは、外に出てないかも知れないね。だから、いわゆる情報系の学校に行って、そういう感じのリクルーティングを受けて入るって言う。スタンダードトラック以外の道だと、確かに中々情報は入ってこないかもしれないし。でも、そういう人は、いわゆるブラックなところに吸い込まれていくんだろうか。

__ささだ__ おー。ブラックな専門学校とか。

__まつもと__ ブラックかどうかは知らないよ (笑)。中村さんがそうかどうかは知らないけど、でもそういう話は良く聞くよね。

__ささだ__ 学校は、どこからどこまでやるの？「Hello, World」の使い方の学校とかじゃなくて？

__nari__ 学校は、Java を教えていて。最初は「Hello, World」みたいな所から始めて、最後はオブジェクト指向とは何ぞやみたいなことを全部。

__ささだ__ 二進数とはとか、そういうのは？

__nari__ そういうとこもやりました。今思えば結構な範囲をきちんと教えてくれてました。

__ささだ__ あ、それはちゃんとやるんだ。クイックソートがどうとかそういうのは？

__nari__ それは無かったですね。

__まつもと__ アルゴリズムには届かない感じだよね。半年じゃ届かないかな。

__nari__ 学校が福岡市内だったんで、家から 2 時間かかるんですよ。帰りも 2 時間かかる。往復 4 時間です。でも、授業は 6 時間くらいで…。

__ささだ__ それを半年。すごいですね。

__nari__ あと生活費と交通費がすごい高くてですね。学費分のお金は貯めてたんですけど、生活費と交通費で全部なくなってしまって、学費丸々マイナスになってしまいました。

__ささだ__ その学校の伝手で就職したんですか？

__nari__ そうです。伝手で就職させてもらって。で、2 年ぐらいやりましたね。仕事。

__ささだ__ Java で？

__nari__ はい。

__ささだ__ その仕事、いかがでした？

__nari__ すごくいい経験でしたね。初めてだったんで、こんな業界なんだって。

__ささだ__ 何やってたんですか？

__nari__ web アプリケーションを作ってました。フレームワークは [Struts](http://struts.apache.org/) です。最後の方は [Seasar](http://www.seasar.org/) を使った気がします。

__ささだ__ いわゆるコンピュータサイエンス的なのが無くても、そう言うところは何も問題なく？

__nari__ 意外と行けましたね (笑)

__まつもと__ そこは行くんじゃない？　だって、Rails 使って web アプリケーション作るのにアルゴリズムとかコンピュータサイエンスが要るかっていうと、要らないよね。

__ささだ__ 何か、パフォーマンスがちょっとでも気になると必要になるとか？

__竹内__ 要らない要らない。

__まつもと__ マジックだよね、その辺はきっと。

__ささだ__ 逆に、その辺を隠蔽しているからフレームワークとして優秀であると言う。

__まつもと__ IT 業界って、たぶん一歩踏み出さないとコンピュータサイエンスは必要ないんだよね。それはそれで間違いだと思うんだけど。

__ささだ__ Java の仕事をやりながら GC に興味を持った？GC に興味を持ったのと、Ruby に興味を持ったのはどっちが先なの？

__nari__ Ruby が先です。その会社で 1 年ぐらい東京に行くんですね。で、そこで RHG を買うんですけど、そもそも C を全然知らなくてですね。

__ささだ__ っていうか、何で買うの？

__nari__ 何で買ったんですかね？

__ささだ__ Ruby の本と間違えた？

__nari__ いやいや、ちゃんと買おうと思って(笑)。

__まつもと__ 間違えて RHG 買ったらそれはそれで不幸な気がしないでもない (笑)

__yhara__ 入門書のつもりで RHG を買った？

__全員__ (笑)

__まつもと__ それは大いなる間違いだ (笑)

__nari__ 青木さんのるびまの出張編があって、それを読んでいて、青木さんの文章はすごい読みやすいなって思って RHG を買ったんですね。で、それを読んでも C が分からないので、何だこりゃ何だこりゃって感じで 2 周か 3 周ぐらいずっと読んでてですね。それで最後の方に GC はまだ改善の余地がある、みたいなことがつらつら書いてあって、じゃあ GC やろう、みたいな。

__まつもと__ その一言が。

__ささだ__ おー。

__竹内__ すごい。

__まつもと__ 青木さんの影響、大きいなぁ。

__nari__ あと、東京でまつもとさんの講演に行ってですね。

__まつもと__ 僕、何か喋ったっけ。

__nari__ Linux か何かのイベントで。

__まつもと__ LinuxWorld？

__nari__ はい、多分。まつもとさんにお会いして。多分覚えてらっしゃらないと思うんですけど。

__まつもと__ わかんない、ごめん。まつもとが何か悪い影響を与えたんじゃないかな。

__nari__ いや、握手してもらって。

__まつもと__ 握手した？　そうなんだ (笑)

__nari__ ああ、もうやろうと。GC やろうって。

__全員__ (笑)

__nari__ GC をやらなければと。

__まつもと__ だけど、僕、この業界の色んな人を見てるけど、大概の人は大学とかでコンピュータサイエンスの教育を受けている人で、そうじゃない中村君はかなり例外的で、その辺は非常に興味深いよね。

__ささだ__ そういう段階から GC 書けるレベルまで行けるんだっていうのがすごい。大学の教育って何だろうみたいな。

__まつもと__ 良いかどうかっていう話をしたら、間違いなく良いんだけど。だって、他の人よりもはるかに GC のこと知ってるから。

__竹内__ すごいよね。

__まつもと__ だけど、普通はつながらないよね。全然コンピュータと関係なくて、民間の学校に行って、全然コンピュータサイエンスとは関係ない web アプリケーションを作るだけの仕事をしていたのに、途中で何かあって(笑)、いきなりこう、多分日本でも上から数えた方が速いぐらいの GC の専門家になってるわけで。

__nari__ その会社でですね、すごく良い先輩にめぐり合ってですね。その先輩がオープンソースとかこういうのがあるっていうか、Seasar とかもあるよみたいな話で僕を導いてくれてですね。で、そこでトントントントンと Ruby の方に行ったっていう。

__まつもと__ そこでモーメントができた。

__nari__ その先輩にはかなり感謝してます。

__ささだ__ なるほど。

__竹内__ けど、それでここまで来るって言うのが俄かには信じがたいよね。

__ささだ__ 最高学府の大学院生に負けてないですね。

__まつもと__ 全然負けてないですね。

__nari__ 皆様のおかげです。

__ささだ__ 何もしない方がいいんですかね？

__まつもと__ わかんない。

__ささだ__ 色々な面白いテーマを与えていったら、勝手に。

__まつもと__ 若者に関していえば、可能性を与えると、ある一定の割合とんでもないのが出てきますよね。とんでもないっていうのは、良い方でとんでもないだけど。

__竹内__ RHG ですか、それを読んで、ずっと分からないままに 2 週間も読んだっていう、それがさすがだね。

__ささだ__ 2 週間じゃなくて、2 周。2 回。

__竹内__ 2 周読んだの！？だからこれが普通の人にはできないよ。だからそこでもう他の人と決定的に違うところがあると思う。

__まつもと__ 何かあると思うね。

__竹内__ 普通、1 周読んだらおしまいだよね。

__まつもと__ RHG はわかんないまま読める本じゃないよ。正直。

__nari__ 座右の銘は「あきらめない」

__全員__ おー (拍手)

__nari__ ポインタが分からなかったです。

__全員__ (笑)

__まつもと__ ポインタが分からないのに読むのは大変だと思うわぁ。

__yhara__ Ruby に無いもんね。Java にもないし。

__nari__ Java にも無いし。ポインタってなんだろうなーみたいな感じで。RHG の対象読者は、関数ポインタまで使える人って書いてあってですね。これは何だろうなみたいな感じで。

__全員__ (笑)

__まつもと__ ポインタじゃなくて関数ポインタだったか。

__ささだ__ Java やりながら、Ruby に興味を持って、GC の話に興味を持って、悶々としていたと。wiki [^29] を作り出したのはその辺？

__nari__ wiki はですね、そこから 1 年ぐらいしてからです。

__ささだ__ GC に目覚めてその後は？

__nari__ 目覚めた後は、Ruby の GC ってこんなもんなんだって感じでですね。論文って何か遠い存在のように思ってたんですけど。

__まつもと__ そりゃ当然だね。

__ささだ__ 論文って、ご存知でした？

__nari__ いや、もう全然知らないです。

__ささだ__ 論文の存在。

__nari__ 論文の存在自体もまったくでした。その時は。RHG に木山さんの論文が載ってて、こういうものがあるんだという。

__ささだ__ うんうん。

__nari__ 木山さんの論文を分からないんですけど読んでて。あーうーん、みたいな感じで。

__まつもと__ あれが分かりにくいんだ。

__全員__ (笑)

__nari__ 情報処理学会があるじゃないですか。あれに入らないと論文が 1 個 600 円ぐらいするんですよね。高いけど買おうかな、みたいな感じで GC の論文をポコポコ買ってたら、5000 円ぐらい 1 ヶ月に行って。

__ささだ__ 情報処理学会の論文買ってるの？　初めて聞いた！

__全員__ (笑)

__nari__ このお金は著者に行くんだろうかみたいな疑問を。

__ささだ__ 行かない行かない (笑)。お金払って出してるからね、論文って。

__竹内__ 論文誌を取らないというあれがあるからね。デフォルトで論文誌取ってるから。全然。

__まつもと__ そういう人たちは自動的にいくらでも見れるんですけど。

__nari__ 情報処理学会は、その時は入ってないんですよ。

__竹内__ 研究会のときは入ってたの？

__nari__ 直前ぐらいに入りました。

__ささだ__ 論文を読もうって言うのが素晴らしいですね。

__まつもと__ RHG を 2 周読んで、論文を読もうと思って。

__ささだ__ 私は大学 4 年まで論文と言うものを知らなかったので。

__まつもと__ それもどうかと思うけど(笑)

__ささだ__ え、だってどういうタイミングで知るんですか、論文って。

__まつもと__ 僕は大学の 2、3 年のときに図書館に篭って論文読んでたもん。

__竹内__ ゼミで論文読めって言われなかった？

__ささだ__ だからそれは 4 年生なんですよ。研究室入ってから。それで、何て素晴らしいものが世の中にはあるんだって思って感動した記憶が。

__まつもと__ 僕も、筑波大の図書館が充実していいたので、日がな一日図書館にいて、なんて素晴らしいんだって思って読みまくってた。

__nari__ GC を調べようとすると、あまりにも情報が web に無くてですね。で、論文が引っかかってくるんで、必然的に論文を読むという。

__ささだ__ すぐ英語の論文になりませんでした？

__nari__ そうですね。でも英語も全然分からないんですけど。苦労しながら読んでます。今もめちゃめちゃ苦労してます。

__まつもと__ まぁねぇ。唯一の GC の情報といえばリチャード・ジョーンズの本ね。

__nari__ ああ、あれを買ったのは大きかったですね。あれは一時期ずっと持ち歩いてですね。これ重いなぁって。

__まつもと__ あれをあげようかって話をしたんだけど、もう持ってるっていう (笑)

__ささだ__ で、そういう風にサーベイの期間があって、サーベイを 1 年ぐらいして、で wiki を作り出したと。

__nari__ そうですね。wiki を作り出したのは多分年末だったと思うんで。正月にこたつに入って、 GC の日本語情報 wiki を作ろうと思って、ペコペコ打ち込みはじめました。

#### NaCl 入社
: ![nari8.jpg]({{site.baseurl}}/images/0028-Hotlinks/nari8.jpg)

__ささだ__ で、さらに時が進んで、NaCl に行こうという風になったの？

__nari__ そうですね。パッチを出してですね。パッチって言うか、blog にちょこちょこと書いてたんですね。こういう GC はどうかなみたいなので。そしたら 1 回まつもとさんにコメントを貰ったんですよ[^30]。で、おぉ、まつもとさんが僕のブログを見てくれてる！と思ってですね。で、次は ML に出そうと思って ML に出して。で、今度はまつもとさんが記事にしてくれてですね、blog の [^31]。

__まつもと__ してたかもしれない。LazySweep だっけ？

__nari__ はい。

__ささだ__ こんなことやってる人がいる。すごい、と。

__まつもと__ それは結構前から知ってたんだけど。wiki とか。

__ささだ__ でも、blog に乗せてくれたからって転職しないでしょ (笑)。

__まつもと__ でも、僕は正直この人欲しいなと思ってたんだ。で、と思ってたらさ、その後 2 週間ぐらいしたら、中村って人が応募してきてとか言って。

__全員__ (笑)

__まつもと__ この人はもしかして、って(笑)。で、僕は面接の担当じゃなくて。人事権が無いんで。是非欲しいってつっついたり、前田君とかに吹き込んどいて (笑)。

__nari__ すごい緊張してですね。最初の面接が後藤裕蔵さんだったんですけど、あ、裕蔵さんだと思って。緊張してしどろもどろになりながら。

__ささだ__ どうでした、第一印象。

__後藤__ うんとね、プログラム書いてもらったら間違えてたんだよね (笑)

__ささだ__ 間違えてた(笑)。

__nari__ ワンライナーで書こうと思ってがんばったんですけど。

__ささだ__ かっこつけすぎた。

__nari__ 括弧が無かったんです。

__後藤__ Range とメソッドの呼び出しの優先順位が間違ってて。

__nari__ 裕蔵さんに「これ括弧がいるんじゃないの」って言われてですね。「あ、どうですかね、いらないんじゃないですかね」って。

__全員__ (笑)

__nari__ 帰った後で打つと、あ、間違ってる。これは落ちたなと思いました。

__全員__ (笑)

__ささだ__ どこを見るんですか？　面接は。

__後藤__ えっ、さらさらっと書ければいいんじゃない？

__ささだ__ さらさらっと書けば、間違ってても？

__まつもと__ パニックを起こさないとか、プログラム書けないとかいうのじゃなければ。

__ささだ__ 止まっちゃうのじゃなければ OK と。

__あんどう__ 書いてもらった後に説明してもらうんですよ。そこで説明してもらっているのが、論理が通っていれば OK。

__ささだ__ なるほど。どっかで聞いたような話ですね。で、無事に転職できたと。

__nari__ はい、無事になんとか入れてもらえました。

__ささだ__ 良かった良かった。

__竹内__ それはいつなんですか？

__nari__ 去年の 5 月です。

__竹内__ ほんと。じゃ、ほんとにほやほやなんだ。

__後藤__ 確か前田さんとかがインフルエンザかなんかで。みんなばたばた倒れてて、松江にきたら一人でレッスンとか。

__ささだ__ で、今、NaCl で幸せに Ruby の仕事をしていると。

__nari__ そうですね。NaCl に来たのは、Ruby を使ってやりたかったんですよ。仕事を。

__まつもと__ Ruby を使って。Ruby を作るんじゃなくて。

__nari__ 作るのもやりたいですけど、Ruby を使って仕事を楽に。

__まつもと__ とりあえず、そこまではクリアできてるね。

__ささだ__ じゃ、まつもとさんがいるから行こうとかじゃないんだ。

__nari__ あ、もちろん、それもあります。

__ささだ__ まつもとさんがいるから COBOL でもいいやとかそういうのは無かった？

__まつもと__ 一歩間違えれば、あっちだったら COBOL だよね。

__nari__ そうですね (笑)

__まつもと__ 大きく分けて、この事務所は三つ部屋があるんですけど、この部屋はひとつで、向こう側の部屋がRuby部屋で、こっち側の部屋が COBOL 部屋なんですよ。

__竹内__ あまり情報交流はなし？

__まつもと__ そんなことは無いですけど、やっぱり文化はだいぶ違いますよね。

__ささだ__ 時間がとんでもないとか。

__まつもと__ それはない。割りとラフな感じだけど。文化が違うって言うのは、プログラミングの文化ね。

__ささだ__ 何かこう、上司には逆らうなとかそういうのではなくて。

__nari__ 転職する前に、大学に行きたいなとか思ってたんですよ。まぁ、お金が無くてですね、やっぱりお金が無いと厳しいなと思って、働けるとこで、すごくスキルが付くのはどこだろうかと考えて、すごい人がいるところじゃないかと。前田さんとか。

__ささだ__ 確かにすごい人がいるよね。

__まつもと__ 周りに有名な人がいるしね。

__nari__ 間違ってなかったかなと。

__まつもと__ スキル付いたかな。

__nari__ かなり教えてもらいました。

__ささだ__ 少なくとも、論文がかけるようになったと言うのはでかいんじゃないですか。

__まつもと__ 確かに。PRO[^32] の論文のときも、アウトラインだけ書いてもらって、あとは全部僕が仕上げないといけないかなと思ってたら、ちゃんと書いてきてさ、感心したんだよね。正直。

__nari__ 論文がかけるとは思ってませんでした。書かせてもらえるとは。

__ささだ__ 日本語、すごいですよね。文章が書ける。

__まつもと__ 掲載はされなかったけどね。

__nari__ (笑)。良い経験です。

__ささだ__ 今度、東京大学への入学もひとつ、ご検討いただけると。

__まつもと__ リモートで受けられるんだっけ？

__ささだ__ テレビ会議室でも置いてやるかな。

__ささだ__ 色々ありがとうございました。普段の仕事は、Ruby？ Rails？

__nari__ Rails やってます。

#### 普段の生活スタイル

__ささだ__ 普段の生活スタイル。

__nari__ 朝に掃除があるんですよ。掃除に来る日もありますし、遅刻してしまう日もあって、今は遅刻してしまう割合が多いかもしれないです。

__まつもと__ 偉くなったなぁ (笑)

__全員__ (笑)

__nari__ 恐縮です (笑)

__ささだ__ 新人は、先輩が来る前に掃除しろと。

__nari__ あ、そういうわけじゃないですけど。前田さんとかも来たら掃除されてますし。

__まつもと__ 偉いね。僕は 12 年間 1 回も掃除したことが無い。

__全員__ (笑)

__まつもと__ それは人間としてどうよって感じがするよね (笑)

__竹内__ 掃除させたら、余計汚くなるとかそういう。

__まつもと__ だいぶあると思う (笑)。掃除させてもらえない。

__nari__ 僕が最初に出社したときにですね、まつもとさん、いらっしゃらなくてですね。まつもとさんは別のオフィスにいるんだなと思ったんですけど、4 時ぐらいにまつもとさんが来てですね、本当にまつもとさんが来るんだ、みたいな。

__まつもと__ 夕方になって来て、7 時ぐらいに帰っちゃうんだよね (笑)。何のために会社にいるんだっていう。

__nari__ びっくりしました。

__yhara__ おはようございますって。

__竹内__ 何時だろうと。

__まつもと__ 僕に対しては、おはようございます。

__ささだ__ 全社的にじゃなくて？

__まつもと__ 全社的には違うよね。

__ささだ__ 4 時には来ないから、他の人は。

__まつもと__ そう。他の人はそんな時間に来ないから。直行で行って、夕方戻ってくる人はいるかもしれないけど。

__nari__ おはようございますですね、僕も。

__竹内__ 駅前のテルサ [^33] だっけ、あそこは行かないんですか、あんまり。

__まつもと__ あそこは僕の机は無いので。行ったら会議室の一角で作業するだけなんで。行ったり行かなかったり。

__ささだ__ 常駐している人もいるんですか？

__まつもと__ テルサの周辺には、サテライトオフィスっていううちの事務所があるんで、そこには 4 人ぐらい常駐しています。

__ささだ__ 基本、営業事務所なんですか？

__まつもと__ 営業が多いよね。

__ささだ__ 市役所とかに行きやすいとか。

__まつもと__ 街中だからね。

__あんどう__ 駅にまず皆さん来るじゃないですか。で、そこでピックアップできるので。ここまで来るのに迷子になるので。

__ささだ__ あー、お客さんを呼ぶときに、あそこはすごくいいですよね。

__まつもと__ 僕も取材とか受けるときはあっちに行ったりするし。東京から来てくれる人に、じゃ、松江駅で、って言うと分かりやすいけど、松江駅からタクシーに乗ってここまでっていうと、みんなめんどくさい。

__ささだ__ 確かに、松江駅から結構ありますよね。

__あんどう__ たまに間違って、テクノプロジェクトさんっていう、通り挟んで向かいに同じ Ruby 系の会社があって、そっちにつれてかれて、このビルじゃないですとか。

__ささだ__ なるほど。生活スタイルは、来たり来なかったりと言う感じですか。

__nari__ まぁ、大体来てます。

__竹内__ ひょっとして、一番新人なんですか？

__ささだ__ コミッタでは一番若いし、一番最近だと思います。

__まつもと__ 成瀬さんはいくつ？

__ささだ__ 成瀬さんの方がちょっと上。26, 7 歳じゃなかったかな。[^34]

__まつもと__ 最初に会ったときが 19 歳だったと言うのがすごいインパクトがすごくて。

__ささだ__ そうそう。彼が大学を卒業して、こないだ就職したから。

__竹内__ NaCl の中では、もっとも若い？

__まつもと__ そんなことはない。あ、でも新人が何歳か分からないな。

__nari__ 同い年ですね。Ruby 部隊では最年少です。

__yhara__ 年齢的には？

__nari__ 年齢的には最年少です。

__竹内__ 年齢的には、最年少………。まぁ、年齢的にはつけなくても最年少とは言いますけど。

__まつもと__ まぁ、新卒とかね。かれは一応中途なんで。

__nari__ NaCl の中では新人ではないという。

__まつもと__ この春入った子もいるので。

__竹内__ ああ、そういう意味ね。

__まつもと__ 去年の 5 月に入った彼は、そういう意味では新人ではない。

__nari__ 僕は中途でしたね。そういえば。

__竹内__ 九州ですよね。

__nari__ はい、九州です。

__竹内__ で、ここに来られる方で、この県内じゃなくて他所から来てる人って、どのぐらいの割合なんですか。

__まつもと__ ここ数年だと、半分以上が県外ですね。ここ数年の入社は、島根県の会社だからというよりも、面白そうな仕事が出来るっていう感じで来る人の方が多いです。

__ささだ__ まつもとさんがいるから、という人が多い？

__まつもと__ えっと、面と向かって聞くのも気恥ずかしいんですけど。

__全員__ (笑)

__まつもと__ まぁ、まつもとがいるからとか、オープンソースや Ruby で仕事が出来るから、っていうので、来てくださる人はそれなりに。

__ささだ__ 今だったら、Ruby で仕事が出来るっていうのは他にも東京でもあるから、やっぱりわざわざ松江に来てるのは、まつもとさんなのかなぁという気はしますけど。原さんは何で？

__yhara__ 面白そうだったから。

__まつもと__ 今日、実行委員をしてくれた前田君とかは、彼が入ったときはまだ有限会社だったんですよ。人数もまだずっとちっちゃくてですね。親御さんが心配されて、うちの息子はちゃんと大学は良い所を出たのに、そんな田舎のいつ無くなるか分からない有限会社に行っていいのかっていう (笑)。面接するときも本当にいいのかって、みんなで聞いて、はいって答えて、今の彼があるわけですけど。彼も、愛知の出身なんで。結構島根出身者は少ないですね。

__竹内__ 人口はどれくらいの町なの？

__まつもと__ 松江市は、20 万をやや切る感じですね。小さいですね。平成の合併でそうなった感じなんで、それ以前は、15 万とか、14 万とか、そんな感じですね。

__竹内__ 駅を降りて、くにびきメッセって数分ですよね。くにびきメッセに行く途中にも、田んぼがあるので。県庁所在地の、歩いて数分のところに田んぼがあるっていう。

__まつもと__ 特異な土地ではありますよね。

__竹内__ なんかね、人が住むにはとても良い土地だなと。

__nari__ 最初来たときには、タヌキが歩いてたんですよ。駅の近くの辺りに。田んぼの辺りにタヌキがいるなって思って。

__竹内__ 田んぼの辺りにタヌキがいるってことは、農薬があんまり使われてないってことかな。

__まつもと__ そうでしょうね。

__nari__ びっくりしました。

__ささだ__ さすがに福岡の方にはいなかった？

__nari__ 僕の実家はすっごい田舎なんですよ。なんで、いることはいたんですけど。

__まつもと__ (松江は)県庁所在地だからね。

__全員__ (笑)

#### 仕事とプライベートの両立

__ささだ__ かなりずれましたが。仕事とプライベートの両立。

__nari__ 全然区別が無いです。

__ささだ__ ここに来てプライベートなことをやってる？

__nari__ も、やってますし。帰って仕事をやることもあります。

__ささだ__ 普段家では何してますか。

__nari__ ほとんど PC を触ってますね。外に出ないんで。

__ささだ__ 趣味的なものとか。

__nari__ 前、サッカーやってたんですけど。

__ささだ__ サッカー。おお。やる方？見る方？

__nari__ やる方です。地元では友達とチーム作ってやってました。ですけど、こっちに来てからまったくやってないですね。

__ささだ__ 運動部とか無いんですか？

__まつもと__ うちはボート部しかないですね。

__ささだ__ ボート部。

__まつもと__ 社長がボート大好きなんですよ。レガッタ。

__ささだ__ マシン室にありましたよね。

__まつもと__ 今はマシン室じゃないところにもあるんですけど (笑)。開発部屋にも既に。ボートマシンていって、ガーっと引く機械があるんですけど。その辺に転がってるんですよ。で、毎週水曜日は少なくとも誰かがこうやって、ガーってやってるんですけど (笑)

__竹内__ 会社にチームがあるの？

__まつもと__ 2 つあります。

__竹内__ 社長が乗ってるのは強い方？ 弱い方？

__まつもと__ 強い方ですね。

__nari__ あ、スノーボードもあります。

__まつもと__ スノーボードもあるね。冬にね。ここは大山 [^35]っていう山が近いので。

__竹内__ あそこは雪降るんですか。

__まつもと__ 降ります。だいぶ減りましたけどね。昔に比べたら。

__ささだ__ 何かには所属してるんですか？

__nari__ スノーボードに。部じゃないですけど、冬になったらスノボーに結構行ってます。

__ささだ__ スポーツ派なんですね。

__nari__ やるときはやりますね。

__まつもと__ 僕も見習わないと (笑)

__全員__ (笑)

__nari__ ささださんは陸上をやられてたんですよね。

__ささだ__ 高校の頃。高校までなので、もう走れません。

__まつもと__ 陸上って、走る方？飛ぶんじゃなくて？

__ささだ__ はい。

__竹内__ 今回のインタビューは一石二鳥だね。二人ともインタビューしたことになりますね。

__ささだ__ (笑)

__竹内__ 今体重何キロですか？中村さん、聞いてください。

__ささだ__ いやいや (笑)。

__ささだ__ えっと、映画とか本とか音楽とか、インドア系の趣味はあります？

__nari__ 音楽は一時期ハマってましたね。60 年代のロックみたいなのを聴いてました。映画も大体、えり好みせずほとんど観るみたいな感じですね。

__ささだ__ ゲームとか。

__nari__ ゲームはもう、最近やらないですね。Wii を買ったんですけど、最近は全然やらなくてですね。どうしようかなと思ってるところですけど。

__yhara__ 会社に置けばいいと思うよ。

__nari__ ここに置きますか (笑)

__竹内__ 社長の机の上においておけば。社運が変わるかもしれない (笑)

__まつもと__ カレンダーの影に、ダーツボードがあるんですよ。

__竹内__ あーなるほど。

__まつもと__ そういえば、ダーツ部ずっとやってたね。

__nari__ ダーツ部もありました。

__竹内__ 時計にぶつけたら大変じゃない。

__まつもと__ この辺の連中は、みんな上手いんで。そういうことは無いみたいですけど (笑)。どうしたらいいんですかね、ブルズアイ[^36]連発されたりすると (笑)

#### 使っているマシン

__ささだ__ 使ってるマシンはそれですか。

__nari__ あ、これですね。

__ささだ__ ThinkPad。はい。

#### 好きな女性のタイプ

__ささだ__ あと、好きな女性のタイプ。

__nari__ 好きな女性のタイプですか。なんでしょうね……。おとなしい人。

__ささだ__ おとなしい人。

__まつもと__ そうなんだ。

__nari__ おとなしい、清純そうな人。

__まつもと__ いいな。

__竹内__ 逆インタビュー、逆インタビュー。

__全員__ (笑)

__ささだ__ これはインタビューの山場なので。おとなしい人。おとなしく GC してる人。

__nari__ いやいや (笑)。GC はしなくていいです (笑)。あ、掃除ってことですか。

__ささだ__ うん。

__nari__ 掃除はしてくれるとありがたいですね。

### 今後について

#### 今後の展望、将来の夢など
: ![nari7.jpg]({{site.baseurl}}/images/0028-Hotlinks/nari7.jpg)

__ささだ__ 今後の展望、将来の夢など。

__nari__ 今後の展望ですか。何でしょう。あ、アメリカで働きたいなていうのはあるんですけど。

__ささだ__ また転職ですか？ EngineYard ？

__nari__ いやいや。30 歳までには行きたいなぁと思ってるんですけど。

__ささだ__ 職も変える？アイスクリームの機械をアメリカに売りに行くとか？

__nari__ そんなことはしないですけど (笑)。向こうでプログラマーをやってみたいなーと思うんです。

__ささだ__ なるほど。教育コストを全部ムダになっちゃいますよ。

__nari__ (笑)

__まつもと__ まぁ、教育コストっていうか、うちはそういうコストをあんまりかけてないよね、正直。

__全員__ (笑)

__ささだ__ 早めに NaCl を見限って。

__まつもと__ 見捨てないで。

__nari__ そんなことは無いです (笑)。でもまぁ、いつかはそうなればいいなぁと。

__ささだ__ 海外で働くというのは、本場っていうのも変ですけど、本場ですもんね。もっと、Ruby 以外のところにもって感じなんですか？

__nari__ いや、なんか漠然としてるんですけど。すごく。向こうで、ちょっとやってみたいなぁっていう。

__まつもと__ EngineYard に口利こうか？

__nari__ いや (笑)

__ささだ__ NaCl の海外支店。

__nari__ それがあるとすごくいいですね。

__ささだ__ まつもとさんを輸出すればすごい。

__まつもと__ まつもと輸出業。そんなに、数無いんで。

__全員__ (笑)

__まつもと__ 1 回輸出したら終わっちゃう (笑)。ビジネスにならない。

__nari__ 輸出したら困るんじゃないですか、日本が。

__竹内__ まず、まつもと人形を作る。

__まつもと__ 十分に教育して、コピーしてありますとかいって。

__全員__ (笑)

#### 次のインタビューイ

__ささだ__ 次、誰ってあります？

__まつもと__ 竹内先生。

__竹内先生__ ダメだよ (笑)

__ささだ__ もうもう、大変なことに。

__nari__ 原さんにしましょう。

__まつもと__ NaCl ツアー。

__ささだ__ また来週来ますんで。

#### 若手に一言

__ささだ__ 若手に一言。

__nari__ 若手に一言ですか？

__まつもと__ 自分も若いからとかいうのが最近の流行。

__ささだ__ 高校生とか、中学生とか、小学生とか。読んでないと思うけど。

__まつもと__ 小学生、中学生は読んでないよな、きっと。

__nari__ コードを書いてない人にはあんまり言うことは無いんですけど、コードをずっと書いている人は、読むことも大事なのかなと。

__まつもと__ 良いことを言う。

__竹内__ やっぱり 2 周読んだから。

__まつもと__ あと、あきらめないね。

__竹内__ 本人の体験に基づいているから。

__まつもと__ 言葉に重みがありますね。

__nari__ (笑)

#### 読者への一言

__ささだ__ 読者に一言。

__nari__ 読者に一言ですか。いやー……。ありがとうございました、じゃおかしいですね。

__ささだ__ 本買ってくださいとか。

__nari__ あ、本買ってください。はい。

__ささだ__ どうもありがとうございました。

__nari__ Hotlinks に出るのが夢だったんですよ。Rubyをはじめた頃に読んで、るびまの中で一番好きな連載です。ついに出れる日が来たんですね。感慨深いですね。

__ささだ__ 素晴らしい。俺も出てみたい。インタビューされたい。

__竹内__ ささだ君はインタビュー出たことないの？

__ささだ__ いやだって、インタビュアーですもん。

__まつもと__ じゃ、僕がしてあげよう。原くん、次はささだ君を指定してください (笑)。

__全員__ (笑)

__ささだ__ どうもありがとうございました。

## 終わりに

今回は Ruby の最年少コミッタで GC の改善に尽力されている nari さんにお話を伺いました。お忙しい中、本当にありがとうございました。次回は、[RubyStation](http://yhara.github.com/ruby-station/index_ja.html) や [Ruby/SDL スターターキット](http://route477.net/w/?RubySDLStarterKit) の作者である yhara さんにお話を伺います。お楽しみに。

(インタビュー：ささだ、編集：いそべ、くげ)

## Rubyist Hotlinks 連載一覧


{% for post in site.tags.Hotlinks %}
  - [{{ post.title }}]({{ post.url }})
{% endfor %}

----

[^1]: 高橋会長はインタビュー開始前に帰られました。
[^2]: [八女茶 - Wikpedia - ](http://ja.wikipedia.org/wiki/%E5%85%AB%E5%A5%B3%E8%8C%B6)
[^3]: 前田さんが上司らしい。
[^4]: 松田さん、角谷さんはインタビュー前に帰る予定でしたが、途中まで参加されました。高橋会長はインタビュー前に帰られました。
[^5]: [スーパーマリオブラザーズのようなものをRubyで作ってみた〜Super Nario GC〜 - I am Cruby (2008/4/22)](http://d.hatena.ne.jp/authorNari/20080422/1208880928)
[^6]: [検索と挿入がともにO(1)であるようなHashを作るにはコツがいる - 卜部昌平のあまりreblogしないtumblr](http://shyouhei.tumblr.com/post/103275104/o-1-hash)
[^7]: 「宴も酣」「宴も闌」のいずれでもよいそうです。
[^8]: http://ll.jus.or.jp/2008/slides/6/authorNari.pdf
[^9]: [RubyistMagazine 0025号「レアでアレなGCの話」]({% post_url articles/0025/2009-02-07-0025-RareAreGCTalk %})
[^10]: Richard Jones「Garbage Collection: Algorithms for Automatic Dynamic Memory Management」。
[^11]: [GC本の必要性 - I am Cruby! (2009/4/13)](http://d.hatena.ne.jp/authorNari/20090413/1239625384)
[^12]: [『Rubyソースコード完全解説』サポートページ](http://www.loveruby.net/ja/rhg/book/)
[^13]: [GCアルゴリズム詳細解説](http://wiki.livedoor.jp/author_nari/)
[^14]: http://www.rubyworld-conf.org/ja/program/abstract/a-5/
[^15]: 正確にはクラスではなく[GCモジュール](http://doc.okkez.net/187/view/class/GC)
[^16]: [コミッタがRuby技術者認定試験に挑んだ話 - I am Cruby! (2008/09/20)](http://d.hatena.ne.jp/authorNari/20080920/1221900292)
[^17]: ちょっと席を外していたらしい。
[^18]: http://www.amazon.co.jp/dp/4873113202
[^19]: [実践『JavaからRubyへ』](http://video.google.com/videoplay?docid=-6128162668211216368#)
[^20]: [mirichiの日記](http://d.hatena.ne.jp/mirichi/)。Rubyist Magazine 0027 号で DXRuby の記事を執筆。([[0027-DXRuby]])
[^21]: Ruby 1.9 から仮想マシンが導入されたので、ここで問題になるマシンスタックの枯渇の問題は起こりづらくなっています。多分。
[^22]: [Ruby Enterprise Edition](http://www.rubyenterpriseedition.com/)。Ruby on Rails の実行速度やメモリ使用量を改善する目的で GC やメモリアロケータを修正した Ruby の実装。
[^23]: copy-on-write friendly な GC を使っている。
[^24]: http://blog.phusion.nl/2009/09/29/ruby-enterprise-edition-1-8-7-20090928-released/
[^25]: [Mostly-Concurrent Mark & Sweep GC のアルゴリズム](http://www.nminoru.jp/~nminoru/java/cms/concurrent_mark_sweep.html)
[^26]: http://research.sun.com/jtech/pubs/04-g1-paper-ismm.pdf
[^27]: RubyWorld Conference 2009 で Ruby の標準化についてセッションがあった。
[^28]: 流れ作業をやっていると考える時間だけは豊富にあります
[^29]: 上にも出てきた GC の wiki のこと。
[^30]: [RubyGCHack - I am Cruby! (2007/11/09)](http://d.hatena.ne.jp/authorNari/20071109/1194610910)
[^31]: http://www.rubyist.net/~matz/20080312.html#p03
[^32]: http://www.math.nagoya-u.ac.jp/~garrigue/pro71/
[^33]: http://www.sanbg.com/terrsa/
[^34]: 25です、半年違いですね
[^35]: 鳥取県西部にある山。中国地方の最高峰。麓にはスキー場が豊富にある。
[^36]: ダーツで、中央の丸のこと。点数が高いが、狙って命中させるのはとても難しい。
